<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">
	

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<base target="_self">
<link rel=File-List href="CHANGES_files/filelist.xml">
<link rel=Edit-Time-Data href="CHANGES_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>TSP++ SDK Contents</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>BestFit</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p
	{font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

	

<body bgcolor=white lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p align=right style='text-align:right'><i><span style='font-size:7.5pt;
font-family:Arial'>TSP++ Version 3.053 (December 2005)</span></i> </p>

<p align=right style='text-align:right'>&nbsp; </p>

<div align=right>

<table class=MsoNormalTable border=0 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt;mso-padding-alt:2.25pt 2.25pt 2.25pt 2.25pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width="50%" style='width:50.0%;padding:2.25pt 2.25pt 2.25pt 2.25pt'>
  <p class=MsoNormal><a name=intro><strong><u><span style='font-size:13.5pt;
  font-family:Verdana'>Changes for this release</span></u></strong></a><span
  style='font-size:13.5pt;font-family:Verdana'>&nbsp;(3.05 - 3.053)</span></p>
  </td>
  <td width="50%" style='width:50.0%;padding:2.25pt 2.25pt 2.25pt 2.25pt'>
  <p class=MsoNormal><img width=9 height=9 id="_x0000_i1025"
  src="images/new.gif" border=0><i>new</i>&nbsp;&nbsp;&nbsp; <img width=9
  height=9 id="_x0000_i1026" src="images/bug_fix.gif" border=0><i>fix</i>&nbsp;&nbsp;&nbsp;
  <img width=9 height=9 id="_x0000_i1027" src="images/back_out.gif" border=0><i>compatibility
  change</i> </p>
  <p>&nbsp;</p>
  </td>
 </tr>
</table>

</div>

<p><img width=9 height=9 id="_x0000_i1028" src="images/new.gif" border=0><span
style='mso-spacerun:yes'> </span>Visual Studio .NET 2005 is now the primary
compiler &#8211; older versions are not supported (but can still be used).</p>

<p><img width=9 height=9 id="_x0000_i1051" src="images/bug_fix.gif" border=0><span
style='mso-spacerun:yes'> </span>Inbound caller ID can now be missing the
international prefix and still be properly formatted.</p>

<p><img width=9 height=9 id="_x0000_i1052" src="images/bug_fix.gif" border=0><span
style='mso-spacerun:yes'> </span>A problem in retrieving <span class=SpellE><b
style='mso-bidi-font-weight:normal'>CTSPIPhoneConnection</b></span> objects by
index has been resolved.</p>

<p><img width=9 height=9 id="_x0000_i1029" src="images/new.gif" border=0><span
style='mso-spacerun:yes'> </span>Added stubs for TAPI 2.2/3.0 Agent
functions.&nbsp; These are now supported by JTAProxy.exe and
JTTSPTrc.dll.&nbsp; The functions are stubbed out in the <span class=SpellE><b>CTSPILineConnection</b></span>
class as:</p>

<blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'>

<p><span style='font-size:10.0pt;color:blue'>virtual</span><span
style='font-size:10.0pt'> LONG <span class=SpellE>CreateAgent</span>(DRV_REQUESTID
<span class=SpellE>dwRequestID</span>, LPHAGENT <span class=SpellE>lphAgent</span>,
LPCTSTR <span class=SpellE>pszMachineName</span>, LPCTSTR <span class=SpellE>pszUserName</span>,
LPCTSTR <span class=SpellE>pszAgentID</span>, LPCTSTR <span class=SpellE>pszAgentPIN</span>);<br>
<span style='color:blue'>virtual</span> LONG <span class=SpellE>SetAgentMeasurementPeriod</span>(DRV_REQUESTID
<span class=SpellE>dwRequestID</span>, HAGENT <span class=SpellE>hAgent</span>,
DWORD <span class=SpellE>dwMeasurementPeriod</span>);<br>
<span style='color:blue'>virtual</span> LONG <span class=SpellE>GetAgentInfo</span>(HAGENT
<span class=SpellE>hAgent</span>, LPLINEAGENTINFO <span class=SpellE>lpAgentInfo</span>);<br>
<span style='color:blue'>virtual</span> LONG <span class=SpellE>CreateAgentSession</span>(DRV_REQUESTID
<span class=SpellE>dwRequestID</span>, LPHAGENTSESSION <span class=SpellE>lphSession</span>,
HAGENT <span class=SpellE>hAgent</span>, LPCTSTR <span class=SpellE>pszAgentPIN</span>,
<span style='color:blue'>const</span> GUID&amp; <span class=SpellE>guid</span>,
DWORD <span class=SpellE>dwWorkingAddressID</span>);<br>
<span style='color:blue'>virtual</span> LONG <span class=SpellE>GetAgentSessionList</span>(HAGENT
<span class=SpellE>hAgent</span>, LPLINEAGENTSESSIONLIST <span class=SpellE>lpSessionList</span>);<br>
<span style='color:blue'>virtual</span> LONG <span class=SpellE>SetAgentSessionState</span>(DRV_REQUESTID
<span class=SpellE>dwRequestID</span>, HAGENTSESSION <span class=SpellE>hSession</span>,
DWORD <span class=SpellE>dwAgentSessionState</span>, DWORD <span class=SpellE>dwNextAgentSessionState</span>);<br>
<span style='color:blue'>virtual</span> LONG <span class=SpellE>GetAgentSessionInfo</span>(HAGENTSESSION
<span class=SpellE>hSession</span>, LPLINEAGENTSESSIONINFO <span class=SpellE>lpSessionInfo</span>);<br>
<span style='color:blue'>virtual</span> LONG <span class=SpellE>GetQueueList</span>(<span
style='color:blue'>const</span> GUID&amp; <span class=SpellE>GroupID</span>,
LPLINEQUEUELIST <span class=SpellE>lpQueueList</span>);<br>
<span class=GramE><span style='color:blue'>virtual</span></span> LONG <span
class=SpellE>SetQueueMeasurementPeriod</span>(DRV_REQUESTID <span class=SpellE>dwRequestID</span>,
DWORD <span class=SpellE>dwQueueID</span>, DWORD <span class=SpellE>dwMeasurementPeriod</span>);<br>
<span style='color:blue'>virtual</span> LONG <span class=SpellE>GetQueueInfo</span>(DWORD
<span class=SpellE>dwQueueID</span>, LPLINEQUEUEINFO <span class=SpellE>lpQueueInfo</span>);<br>
<span style='color:blue'>virtual</span> LONG <span class=SpellE>GetGroupList</span>(LPLINEAGENTGROUPLIST
<span class=SpellE>lpGroupList</span>);<br>
<span style='color:blue'>virtual</span> LONG <span class=SpellE>SetAgentStateEx</span>(DRV_REQUESTID
<span class=SpellE>dwRequestID</span>, HAGENT <span class=SpellE>hAgent</span>,
DWORD <span class=SpellE>dwState</span>, DWORD <span class=SpellE>dwNextState</span>);<o:p></o:p></span></p>

</blockquote>

<p><img width=9 height=9 id="_x0000_i1030" src="images/new.gif" border=0><span
class=GramE>Added support to save the TSP configuration back to a stream from
the TSP library.</span>&nbsp; This allows the TSP to alter the configuration
when dynamic changes are detected.</p>

<p><img width=9 height=9 id="_x0000_i1031" src="images/new.gif" border=0>Corrected
some versioning problems with newer <b>TAPI.H</b> header files in the Platform
SDK where the <b>LINEDEVCAPS</b> structure would be sized incorrectly when the
capabilities are queried.</p>

<p><img width=9 height=9 id="_x0000_i1032" src="images/new.gif" border=0>&nbsp;Removed
requirement to define the TAPI version prior to including TAPI.H or TSPI.H -
TSP++ now mandates TAPI 3.x to avoid structure <span class=SpellE>mis</span>-sizing
problems.&nbsp; <u><span style='color:red'>This means you will need to remove
any #include for TAPI.H or TSPI.H and let the TSP++ headers include those files
itself.</span></u></p>

<p><img width=9 height=9 id="_x0000_i1033" src="images/new.gif" border=0>Added
a new <b>NO_TRACE</b> define which may be used to disable the <b>JTSPTrc.DLL</b>
support normally built into the library.&nbsp; If this macro is defined in the
project, <b>JTSPTrc.DLL</b> will not be loaded by the TSP when it is started.</p>

<p><img width=9 height=9 id="_x0000_i1034" src="images/new.gif" border=0><span
class=GramE>Added a new method <span class=SpellE><b>CServiceProvider::Instance</b></span>
which retrieves the single instance pointer of the <span class=SpellE><b>CServiceProvider</b></span>
class.</span>&nbsp; This can be used in place of the global <span class=SpellE><span
class=GramE><b>GetSP</b></span></span><span class=GramE><b>(</b></span><b>)</b>
macro if desired.</p>

<p><img width=9 height=9 id="_x0000_i1035" src="images/new.gif" border=0><span
class=GramE>Added new method <span class=SpellE><b>CTSPIAddressInfo::GetDialingParameters</b></span>
to retrieve the dialing parameters for a specific address.</span>&nbsp; In
previous versions, this information was not tracked per address and was instead
merged at the line level.&nbsp; <u><span style='color:red'>This also changes
the signature for the <span class=SpellE><b>CTSPIAddressInfo::Init</b></span>
function.</span></u><span style='color:red'>&nbsp; </span>The new signature is:</p>

<blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'>

<p><span style='font-size:10.0pt;color:blue'>virtual</span><span
style='font-size:10.0pt'> <span style='color:blue'>void</span> Init (<span
class=SpellE>CTSPILineConnection</span>* <span class=SpellE>pLine</span>, DWORD
<span class=SpellE>dwAddressID</span>, LPCTSTR <span class=SpellE>lpszAddress</span>,<br>
&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style='font-size:10.0pt'>LPCTSTR <span class=SpellE>lpszName</span>, <span
class=SpellE><span style='color:blue'>bool</span></span> <span class=SpellE>fIncoming</span>,
<span class=SpellE><span style='color:blue'>bool</span></span> <span
class=SpellE>fOutgoing</span>, DWORD <span class=SpellE>dwAvailMediaModes</span>,<br>
&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style='font-size:10.0pt'>DWORD <span class=SpellE>dwAvailBearerModes</span>,
DWORD <span class=SpellE>dwMinRate</span>, DWORD <span class=SpellE>dwMaxRate</span>,<br>
&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style='font-size:10.0pt'>DWORD <span class=SpellE>dwMaxNumActiveCalls</span>,
DWORD <span class=SpellE>dwMaxNumOnHoldCalls</span>,<br>
&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style='font-size:10.0pt'>DWORD <span class=SpellE>dwMaxNumOnHoldPendCalls</span>,
DWORD <span class=SpellE>dwMaxNumConference</span>,<br>
&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style='font-size:10.0pt'>DWORD <span class=SpellE>dwMaxNumTransConf</span>,
DWORD <span class=SpellE>dwAddressSharing</span>, <b><u><span style='color:
blue'>const</span> LPLINEDIALPARAMS <span class=SpellE>lpDialParams</span>,</u></b>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
DWORD <span class=SpellE>dwAddressType</span>);<o:p></o:p></span></p>

</blockquote>

<p><img width=9 height=9 id="_x0000_i1036" src="images/new.gif" border=0><span
class=GramE>Added new method <span class=SpellE><b>CTSPIPhoneConnection::GetLFChar</b></span>
to retrieve the line-feed character for the display.</span></p>

<p><img width=9 height=9 id="_x0000_i1037" src="images/new.gif" border=0>&nbsp;<span
class=GramE>Added new timing support for calls (<span class=SpellE><b>CTSPICallAppearance::AddTimedEvent</b></span>)
which allows timer events to be added by users of the library.</span>&nbsp;
This is now used in all places where calls must be timed.</p>

<p><img width=9 height=9 id="_x0000_i1038" src="images/new.gif" border=0>Added
a new virtual method to the <span class=SpellE><b>CThreadPoolMgr</b></span><b> </b>template
class which allows overriding of when worker thread creation happens.&nbsp; The
new function is called when a new request is added to the worker pool and has
the following signature:</p>

<p><span style='font-size:10.0pt;color:blue'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>bool</span></span></span><span
style='font-size:10.0pt'> <span class=SpellE>CThreadPoolMgr::CheckForThreadCreate</span>(<span
class=SpellE><span style='color:blue'>int</span></span> <span class=SpellE>nQueued</span>)
<span style='color:blue'>const<o:p></o:p></span></span></p>

<p>Return <b>true</b> if a new thread should be created, <b>false</b> if
not.&nbsp; The default behavior of the template is the same as previous
versions of TSP++ (i.e. a thread is created if we have no threads, or if our
queue threshold is exceeded).</p>

<p><img width=9 height=9 id="_x0000_i1039" src="images/bug_fix.gif" border=0>Corrected
all instances of returning direct references to <span class=SpellE><b>TString</b>s</span>
to be <b>const <span class=SpellE>TString</span>&amp;</b>.&nbsp; <u><span
style='color:red'>This means you must change your function signature if you
override any of these functions.</span></u></p>

<p>This includes:<br>
<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
class=SpellE>CTSPIConnection::GetIcon</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
class=SpellE>CTSPIConnection::GetID</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
class=SpellE>CTSPILineConnection::GetDevConfig</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
class=SpellE>CTSPILineConnection::SetDevConfig</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
class=SpellE>CTSPIAddressInfo::GetID</span><br>
</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
class=SpellE><b>CTSPICallAppearance::GetPartiallyDialedDigits</b></span><b><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
class=SpellE>CTSPICallAppearance::GetID</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
class=SpellE>CServiceProvider::TraceOut</span></b></p>

<p><img width=9 height=9 id="_x0000_i1040" src="images/bug_fix.gif" border=0>Removed
many unnecessary try/catch statements where exceptions cannot be thrown within
the try block.</p>

<p><img width=9 height=9 id="_x0000_i1041" src="images/bug_fix.gif" border=0>&nbsp;Corrected
some casts to compile under both VC6 and VC7 where the new compiler is a bit
more stringent and complains about a valid cast.</p>

<p><img width=9 height=9 id="_x0000_i1042" src="images/new.gif" border=0><span
class=GramE>Several STL performance improvements which also cleanup the code.</span>&nbsp;
Changed some of the code related to checking STL containers to use the <span
class=GramE><b>empty(</b></span><b>)</b> member when available for
performance.&nbsp; Also changed a few places where <span class=GramE><b>size(</b></span><b>)</b>
is used multiple times to cache the size in a variable rather than querying the
container multiple times.</p>

<p><img width=9 height=9 id="_x0000_i1043" src="images/back_out.gif" border=0><span
class=GramE>Scoped auto-deleting containers within the <span class=SpellE><b>tsplib</b></span>
namespace for compatibility with some third-party class libraries.</span></p>

<p><img width=9 height=9 id="_x0000_i1044" src="images/new.gif" border=0><span
class=GramE>Rewrote the auto-deleting container templates using a better <span
class=SpellE>templated</span> structure which allows them to be easily replaced
if desired.</span><br>
<br>
<img width=9 height=9 id="_x0000_i1045" src="images/bug_fix.gif" border=0><span
class=GramE>Removed the audit trail file support.</span>&nbsp; This was the
section of code most often replaced and added a significant size increase for
not being used in the executable.</p>

<p><img width=9 height=9 id="_x0000_i1046" src="images/bug_fix.gif" border=0><span
class=GramE>Changed the method of walking call hubs.</span>&nbsp; Instead of
locking the hub during the enumeration of a group of calls, the array is copied
and enumerated separately.&nbsp; This removes a potential dead lock scenario
where a call is removed from the hub while being enumerated.</p>

<p><img width=9 height=9 id="_x0000_i1047" src="images/bug_fix.gif" border=0>Fixed
a bug related to negotiating the extended version on a line before the line is
actually opened.</p>

<p><img width=9 height=9 id="_x0000_i1048" src="images/bug_fix.gif" border=0><span
class=GramE>Fixed a bug which resulted in a crash when there are no locations available
to TAPI.</span></p>

<p><img width=9 height=9 id="_x0000_i1049" src="images/new.gif" border=0>No
longer require a pre-CRT <span class=SpellE>DLLMain</span> to be used.&nbsp;
This removes a link issue when MFC and other third party libraries are linked
to the project.</p>

<div class=MsoNormal align=center style='text-align:center'>

<hr size=2 width="100%" align=center>

</div>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:7.5pt'>© 2004-2005 JulMar Technology, Inc.</span> </p>

</div>

</body>

</html>
